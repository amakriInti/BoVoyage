
@{
    ViewBag.Title = "Affichage Voyage";
}

<script src="/Scripts/jquery-3.4.1.min.js"></script>
<style>
    #div1 {
        display: flex;
        justify-content: center;
    }

    .tailleimage {
        /*width: 80%;*/
        height: 70%;
        margin: 10px;
    }

    .dimTd {
        text-align: center;
        width: 150px;
        height: 190px;
        margin: 5px;
    }
</style>

<h1 style="text-align:center">Liste des voyages proposés</h1>

<h3 style="color: @ViewBag.color">@ViewBag.ajoutok</h3>
<div>
    Voyage :
    <select id="lieu">
        <option> </option>
        <option value="Continent"> Continent</option>
        <option value="Pays"> Pays</option>
        <option value="Region"> Region</option>
    </select>
    <input type="text" id="txtlieu" />
    <br /> <br />
    <input type="button" id="listeVoyageTrie" value="Go" />
    <br /> <br />

    <div id="div1"><p> résultat ici </p> </div>
</div>

<script>


    $('#listeVoyageTrie').click(function () {
        var lieu = $('#lieu').val();
        var txtlieu = $('#txtlieu').val();
        $.ajax({
            type: "GET",
            url: "https://localhost:44307//Api/Voyages/?lieu=" + lieu + "&txtlieu=" + txtlieu,
            datatype: 'application/json',
            contentType: 'application/json',
            success: function (data, status) {
                if (status == "success") {
                    fragment = "<table>";
                    for (var i = 0; i < data.length; i+=3) {
                        if (i < data.length) {
                            fragment += "<tr><td> <div class='col-lg-4'><div class='card' style='width: 30rem; '>" +
                                "<img src='/Photo/" + data[i].Image + "' style='width: 100 % ' />" +
                                " <div class='card-body'> <h3 class='card-title'>" + data[i].Pays + "</h3> <p class='card-text'>" +
                                data[i].DescriptionDestination +
                                "</p > <a href='https://localhost:44307/Home/DetailsVoyage/" + data[i].Id + "' class='btn btn-primary'>A partir de " + data[i].PrixVenteUnitaire + "€</a></div ></td > ";
                        }

                        if (i + 1 < data.length) {
                            fragment += "<td> <div class='col-lg-4'><div class='card' style='width: 30rem; '>" +
                                "<img src='/Photo/" + data[i + 1].Image + "' style='width : 100%' />" +
                                " <div class='card-body'> <h3 class='card-title'>" + data[i + 1].Pays + "</h3> <p class='card-text'>" +
                                data[i+1].DescriptionDestination +
                                "</p> <a href='https://localhost:44307/Home/DetailsVoyage/" + data[i + 1].Id + "' class='btn btn-primary'>A partir de " + data[i + 1].PrixVenteUnitaire + "€</a></div></td>";
                        }

                        if (i + 2 < data.length) {
                            fragment += "<td> <div class='col-lg-4'><div class='card' style='width: 30rem; '>" +
                                "<img src='/Photo/" + data[i + 2].Image + "' style='width : 100%' />" +
                                " <div class='card-body'> <h3 class='card-title'>" + data[i + 2].Pays + "</h3> <p class='card-text'>" +
                                data[i+2].DescriptionDestination +
                                "</p> <a href='https://localhost:44307/Home/DetailsVoyage/" + data[i + 2].Id + "' class='btn btn-primary'>A partir de " + data[i + 2].PrixVenteUnitaire + "€</a></div></td></tr>";
                        }
                        }
                    fragment += "</table>"
                    $('#div1').html(fragment);
                }
            },
            error: function (xhr, status, error) {
                $('#div1').html("Erreur");
            }
        });
    })

</script>
<hr />
