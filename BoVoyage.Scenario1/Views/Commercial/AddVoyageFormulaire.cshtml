@{
    ViewBag.Title = "Ajout d'un voyage depuis un formulaire";
}

<h2>Ajouter un nouveau voyage</h2>

<div class="form-horizontal">
    <h4>Formulaire</h4>
    <hr />
    @Html.ValidationSummary(true, "", new { @class = "text-danger" })
<form class="needs-validation" novalidate>
    @Html.AntiForgeryToken()
    <!--Fournisseur-->
    <div>
        <!--Liste déroulante-->
        <div class="input-group mb-3">
            <div style="width:20%;" class="input-group-prepend ">
                <label class="input-group-text " for="Fournisseur">Fournisseur :</label>
            </div>
            <select style="width:50%;" class="form-select" id="Fournisseur" onchange="TextboxAutre()" required>
                <option selected disabled value="">Choix du fournisseur</option>
                <option value=1>One</option>
                <option value=2>Two</option>
                <option value="Autre">Autre</option>
            </select>
            <div class="invalid-feedback">
                Veuillez sélectionner un champs.
            </div>
        </div>

        <!--Nouveau fournisseur ajout automatique via JS-->
        <!--<div class="input-group mb-3">
            <div style="width:20%;" class="input-group-prepend ">
                <label class="input-group-text " for="inputGroupSelect05">Nom du nouveau fournisseur :</label>
            </div>
            <input type="text" class="form-control" required>
            <div class="invalid-feedback">
                Veuillez remplir le champ ou sélectionner un fournisseur.
            </div>
        </div>-->
        <div id="div_NewFournisseur"></div>
    </div>

    <!--Calendrier-->
    <div class="input-group input-daterange">
        <!--Date de départ-->
        <div class="input-group mb-3">
            <div style="width:20%;" class="input-group-prepend ">
                <label class="input-group-text " for="inputGroupSelect02">Date de départ :</label>
            </div>
            <input type="text" class="form-control" id="start" placeholder="JJ/MM/AAAA" data-date-format="dd/mm/yyyy" required>
            <div class="input-group-text">
                <label><i class="fa fa-calendar"></i></label>
            </div>
            <div class="invalid-feedback">
                Veuillez renseigner une date de départ.
            </div>
        </div>

        <!--Date de retour-->
        <div class="input-group mb-3">
            <div style="width:20%;" class="input-group-prepend ">
                <label class="input-group-text " for="inputGroupSelect03">Date de retour :</label>
            </div>
            <input type="text" class="form-control" id="end" placeholder="JJ/MM/AAAA" required>
            <div class="input-group-text">
                <label><i class="fa fa-calendar"></i></label>
            </div>
            <div class="invalid-feedback">
                Veuillez renseigner une date de retour.
            </div>
        </div>
    </div>

    <!--Nombre de place disponible-->
    <div class="input-group mb-3">
        <div style="width:20%;" class="input-group-prepend ">
            <label class="input-group-text " for="inputGroupSelect04">Nombre de place disponible :</label>
        </div>
        <select style="width:50%;" class="form-select" id="inputGroupSelect01" required>
            <option selected disabled value="">Nombre de participant</option>
            <option value=1>1</option>
            <option value=2>2</option>
            <option value=3>3</option>
            <option value=4>4</option>
            <option value=5>5</option>
            <option value=6>6</option>
            <option value=7>7</option>
            <option value=8>8</option>
            <option value=9>9</option>
            <option value=10>10</option>
            <option value=11>11</option>
            <option value=12>12</option>
            <option value=13>13</option>
            <option value=14>14</option>
            <option value=15>15</option>
        </select>
        <div class="invalid-feedback">
            Veuillez sélectionner un champs.
        </div>
    </div>

    <!--Prix d'achat-->
    <div class="input-group mb-3">
        <div style="width:20%;" class="input-group-prepend ">
            <label class="input-group-text " for="inputGroupSelect05">Prix d'achat :</label>
        </div>
        <input type="number" class="form-control" id="DecimalField" aria-label="Sizing example input" aria-describedby="inputGroup-sizing-default" min="0" step='0.01' required>
        <div class="input-group-append">
            <span class="input-group-text">Format: 0,00€</span>
        </div>
        <div class="invalid-feedback">
            Veuillez vérifier le format 0,00.
        </div>
    </div>

    <!--Prix de vente-->
    <div class="input-group mb-3">
        <div style="width:20%;" class="input-group-prepend ">
            <label class="input-group-text " for="inputGroupSelect06">Prix de vente :</label>
        </div>
        <input type="number" class="form-control" id="DecimalField" aria-label="Sizing example input" aria-describedby="inputGroup-sizing-default" min="0" step='0.01' required>
        <div class="input-group-append">
            <span class="input-group-text">Format: 0,00€</span>
        </div>
        <div class="invalid-feedback">
            Veuillez vérifier le format 0,00.
        </div>
    </div>

    <!--Description-->
    <div class="input-group mb-3">
        <div style="width:20%;" class="input-group-prepend ">
            <label class="input-group-text " for="inputGroupSelect07">Description :</label>
        </div>
        <textarea class="form-control" aria-label="With textarea" required></textarea>
        <div class="invalid-feedback">
            Veuillez remplir ce champs.
        </div>
    </div>
    <div class="col-12">
        <button class="btn btn-primary" type="submit">Submit form</button>
    </div>
</form>
</div>


@section DatePicker{
    <script>
        /*--------------------------------------
        //Ajout textbox si nouveau fournisseur
        --------------------------------------*/
        function TextboxAutre() {
            let value = document.getElementById("Fournisseur").value;
            if (value = "Autre") {
                codeHTML = "<div class='input-group mb-3'>" +
                                "<div style = 'width:20%;' class='input-group-prepend'>" +
                                    "<label class='input-group-text' for='newFournisseur'>Nom du nouveau fournisseur :</label>" +
                                "</div>" +
                                "<input type='text' class='form-control' required>" +
                                "<div class='invalid-feedback'>" +
                                    "Veuillez remplir le champ ou sélectionner un fournisseur." +
                                "</div>" +
                            "</div>";
                $("#div_NewFournisseur").html(codeHTML);
            }
        }

        /*--------------------------------------
        //Calendrier
        --------------------------------------*/
        //date du jour
        var today = new Date();
        today.setDate(today.getDate());

        //Option mini calendrier datepicker
        //div encadrant input class=input-daterange
        //input :(id=start, id=end)
        $('.input-daterange').datepicker({
            language: 'fr',
            orientation: "top right",
            autoclose: true,
            calendarWeeks: true,
            clearBtn: true,
            disableTouchKeyboard: true,
            weekStart: 1,
            setDate: new Date(),
            todayHighlight: true,
            startDate: today,
            format: 'dd/mm/yyyy'
        });

        /*--------------------------------------
        //Erreur
        --------------------------------------*/
        (function () {
            'use strict'

            // Fetch all the forms we want to apply custom Bootstrap validation styles to
            var forms = document.querySelectorAll('.needs-validation')

            // Loop over them and prevent submission
            Array.prototype.slice.call(forms)
                .forEach(function (form) {
                    form.addEventListener('submit', function (event) {
                        if (!form.checkValidity()) {
                            event.preventDefault()
                            event.stopPropagation()
                        }

                        form.classList.add('was-validated')
                    }, false)
                })
        })()

        /*--------------------------------------
        //Format decimal
        --------------------------------------*/
        $("#DecimalField").blur(function () {
            this.value = parseFloat(this.value).toFixed(2);
        });
    </script>
}
